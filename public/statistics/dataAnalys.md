# データ分析

## 参考書籍

- 以下の書籍の自分なりのまとめ
  [データ分析に必須の知識・考え方 統計学入門(阿部 真人)](https://books.rakuten.co.jp/rb/16943959/)

## 1.1 データを分析する

### 〇データ分析の目的

データ分析の主な目的として、大きく以下の３つ 1. データを要約すること 1. 対象を説明すること 1. 新しく得られるデータを予測すること

#### 〇データを要約すること

生のデータをただ眺めてもなんもわからない。　 ⇒ 　データを要約して整理する手法が必要
例）平均値でデータの要約をする

#### 〇対象を説明すること

対象が持つ性質・関係性を明らかにし理解につなげること。人間だれしも自身の身の回りの事柄を観察し、関係性を見つけようとしている。
例）　赤いリンゴを食べたら甘く、青いリンゴを食べたらすっぱい　 ⇒ 　リンゴの色と味の間に関係性があるのでは？

ただし、ただただデータをとってグラフ化しただけでは、「たまたま得られた」可能性を排除できないし、傾向の強さの評価もできない。
**そこで、データ分析手法を用いることが必要になり、それによって初めて客観的な証拠（エビデンス）を手にしたことになる**

また説明（または理解）にはレベルが存在する。一般にデータ分析で登場する関係性には「因果関係」と「相関関係」がある。（詳しくは後述）

- 因果関係
  - ２つのうち一方（要因）を変化させると、もう一方（結果）を変えることができる関係（「○○ すると △△ となる」）
  - 因果関係がわかるということは仕組み（メカニズム）に関する知見を与えるので深い理解である
  - 例えば薬と血圧の関係で、薬の量で血圧が下がるとか？
  - ちなみに、要因を変化させることを「介入」という
  - 望ましい結果を得るように要因を変化させることを「制御」という
- 相関関係
  - 一方が大きいともう一方も大きい（または一方が大きいともう一方は小さい）という関係
  - 一方を変化させたときにもう一方が変化するとは限らない
  - 仕組みに関するいくつかの可能性を区別できないので浅い理解
  - 例えば年収と幸福度の関係で、必ずしも高年収が幸福とは限らないとか？
    - 逆に幸福度が高まると性格がポジティブになり仕事がうまくいくことで年収も上がった？
  - 相関関係は可能性を区別できない。
  - ただし相関関係があれば、未知データの予測が可能になる

#### 未知データを予測する

すでに得られたデータを基に、今後新しく得られるデータを予測すること
例）各年の夏の平均気温と秋の農作物収穫量の間にみられる関係から、その年の平均気温を基に秋の主閣僚を予測する
実際には予測とズレが生じるが、統計分析すうｒことでできるだけズレが少ない関係性を見出すことが可能になる。
そしてズレがどの程度なのかを評価することも重要である。

## 1.2 統計学の役割

### 〇統計学はばらつきの多い対象に対して力を発揮する。

データ分析における統計学ん重要な役割は「ばらつき」のあるデータに立ち向かい、説明や予測を行うこと。
「ばらつき」とはデータ一つ一つの値の差異。（一人ひとり身長が違うこととか）
統計学はこのようなばらつきを「不確実性」として評価し、「対象の説明と予測」を行う

### 〇確率を使う

統計学はばらつきや不確実性に対処する方法を与えてくれる。
その根底にあるのは、ばらつきや不確実性を確率として表現する確率論である。
そのため、統計学を学ぶにあたって確率の考え方が必須。

## 1.3 統計学の全体像

- 得られたデータを整理して要約する方法を[記述統計](#全数調査)と呼ぶ
  - データを基に平均や分散、グラフを出すこと
  - これによってデータそのものの特徴や傾向を把握することができる
  - 得られているデータだけに注目し、データ自体の性質を知ることが目的である
- 得られたデータからデータの発生元の対象を推測する手法を[推測統計](#標本調査)と呼ぶ
  - 対象の理解や未知データの予測のためには、データそのものではなく、データの発生元を知ることが必要。
  - データからデータの発生元を推測するにあたり、そもそもデータを得るとはどういうことかを考える必要がある。（後述）　・・・深い。。。

### 確率モデル（ここは結構大事かも）

データは対象を観測して得られたが、この対象の性質自体は直接観測できないし、扱うことも困難である。そこでデータが比較的単純な確率的な装置から姿勢されたと仮説してみる。この確率的な装置を「確率モデル」と呼ぶ。

- 具体例：さいころ
  - 現実のさいころは物理的な法則に従い、ほんの少しの動きの違いが、どの目が出るかを不確実にする。さいころを投げる手の動きから空気の流れまで精度よく観測し、どの目が出るかを記述するのは非常に困難。
  - そこで我々は確率を使って、さいころを各目が確率 1/6 で現れる「確率モデル」として表現している。

### 統計的推定と仮説検定

推測統計は主に以下の２つがある

- 統計的推定(statistical inference)
  - データから仮設した確率モデルの性質を推定する手法
  - 例えば少し角がかけたさいころは 1/6 でないかもしれない。そこで各目がどの程度の確率で出るさいころなのかを得られたデータから推測する。
- 仮説検定(statistical test)
  - 立てた仮説と得られたデータがどれだけ整合するかを評価し、仮設を支持するかどうかを判断する手法
  - 例えば少し角がかけたさいころでも均等に 1/6 で各目が出るという仮説をたて、100 回投げたら 1 の目が 50 回も出た場合は仮説が誤りだと判断する

### 様々な分析手法

統計分析には様々な手法がある。
その理由はデータのタイプや変数の数、仮定する確率モデルなどによって用いる手法が異なるから。

- データのタイプ
  - カテゴリ変数：血液型のようなカテゴリとして扱う
  - 量的変数：身長のような数値と扱う

## 2 母集団と標本

### 2.1 データ分析の目的と興味の対象

- データ分析の目的を設定する。
  〇〇を説明する、□□ を予測するといった具体的なデータ分析の目的を定めることで、どのような実験・観測を通してデータを得るべきか、どのようなデータを分析するべきかが変わってくる。
  研究やビジネスのデータ分析において、目的を明確にしないまま得られたデータに対し、いい加減なデータ分析手法を適用してなにか重要な発見をする、成果を出すというのは困難を極める。

- 興味の対象を設定する（データの範囲）
  - 血圧の新薬の効果を知る → **あらゆる(実際の治験参加者だけでなくすべての)** 高血圧の人
  - クラス対抗のテスト点数 → クラスに在籍している学生の人数

### 2.2 母集団

上述の興味の対象全体のまとまりを、**母集団(population)** という。
母集団のとらえ方も重要で、上述の血圧の例を取ると、新薬を与えられた人たちの母集団、与えられていない母集団を考えられる。

- 有限母集団
  要素数が有限の母集団。

- 無限母集団
  要素数が無限の母集団。

興味の対象の設定次第で、有限にも無限にもなる
例）　現在の日本人の平均身長　 → 　有限
　　　日本人の平均身長　 → 　無限（過去、未来も含めると人数は無限に広がる）

### 2.3 母集団の性質

#### 全数調査

母集団に含まれる要素数が有限であり、すべて調査可能な調査方法。母集団が無限の場合は調査は不可能。
例）　国民全員に対して調査する国勢調査

#### 標本調査

母集団の一部を分析することで母集団の性質を推測する推測統計(Inferential statistics)という枠組みがある。推測統計で調べる母集団の一部のことを**標本（サンプル）**といい、標本を母集団から取り出すことを、**標本抽出（サンプリング）**という。標本から母集団の性質を調べることを**標本調査**という。推測統計は母集団の性質について 100%言い当てることはできず、不確実性をともなって評価することになるのは確か。
例）一部の世帯を対象としてモニタリングし、全世帯の視聴率を推測している TV 視聴率

#### 標本の大きさ

母集団から抽出された標本は、有限の数の要素を含んでいる。標本に含まれる要素の数を、**標本の大きさ（サンプルサイズ、標本サイズ）**と呼び、アルファベットの$n$で表記する。
また、「サンプル数」という言葉は「サンプルサイズ」とは異なり、**標本の数**となるので注意。（２０人からなる標本 A と３０人からなる標本 B がある場合は、サンプル数が「２」となる。）

**サンプルサイズは母集団の性質を推測したときの確からしさや、仮説検定の結果にもかかわるため、重要な要素の一つであることを認識すること。**

## 3 統計分析の基礎

### 3.1 データのタイプ

#### 〇変数

データの内、共通の測定手法で得られた同じ性質をもつ値を**変数**という。（例　身長、体重）
データが１つだけ（身長のみ）なら１変数のデータ、身長と体重の２つなら２変数のデータ・・・といった風に変数が多ければ多いほど複雑になっていく。
統計学では変数の数を**次元**と表現することもある。２変数のデータなら２次元の平面上に各値をプロットしてグラフにできるから。

##### 量的変数

変数が数値で表される場合、「量的変数」という。その中でも以下の２つに分類可能。

- 離散型
  取りうる値が飛び飛びである変数を離散型の量的変数（離散変数）という。
  例）　さいころの値、回数や人数といったデータ
- 連続型
  連続値で表される変数を連続型の量的変数（連続変数）という。
  例）　身長、体重

##### 質的変数（カテゴリ変数）

変数が数値でなくカテゴリで表される場合、「質的変数またはカテゴリ変数」という。
例）　アンケートの Yes/No、コインの表/裏、晴れ/曇り/雨/雪といった天気・・・

### 3.2 データの分布

グラフを用いて「データがどこにどのように分布しているか」を可視化し、大まかにでーたの傾向を把握することが、データ分析の最初のステップ。

データの分布を可視化するにはある値がデータの中に何個含まれるか（度数、カウント数）を表すグラフである**度数分布図（ヒストグラム）**がよく使われる。
データのタイプによって、ヒストグラムの定義が異なっていく。

#### 離散型の量的変数のヒストグラム

![さいころヒストグラム](./img/diceHistgram_n100.png)

横軸は数値、縦軸はその数値がデータに現れた個数（回数や度数、カウント数）を表す。

#### 連続型の量的変数のヒストグラム

![身長ヒストグラム](./img/身長ヒストグラム例.png)
連続型の場合厳密には小数点以下がいくらでも続くので同じ値は起こりえない。
そのため、ある範囲を設定しその範囲に含まれる数値の個数をカウントして縦軸とする。この範囲の幅のことを「ピン幅」という。

参考)[なるほど統計学園](https://www.stat.go.jp/naruhodo/4_graph/shokyu/histogram.html)

#### カテゴリ変数のヒストグラム

![カテゴリ変数](./img/category.png)
横軸は各カテゴリ、縦軸は各カテゴリのカウント数を表す。カテゴリ変数の値には大小関係はないので、横軸の順番に特別な意味はない。

参考)[Pandas でテーブルデータの数値・カテゴリ変数をヒストグラムで一括で表示](https://qiita.com/st07d31/items/5ae714c0c83609c7a84b)

#### ヒストグラムは可視化に過ぎない

**大まかなデータの分布はわかるものの、可視化だけでは見た人の主観的な判断にゆだねられてしまい、データの正確な記述や、対象の理解といった目的は達成できない。そこで **数値的な統計分析** が必要となってくる**

### 3.3 統計量

####
